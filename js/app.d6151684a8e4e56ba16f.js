"use strict";(self.webpackChunkmrmarble_dev=self.webpackChunkmrmarble_dev||[]).push([[143],{863:(e,t,s)=>{const i=s(477),a=s(217),n=s(854),r=s(108),o=s(458),h=s(525);class d{constructor(e){const{width:t,height:s,left:a,top:n}=e.getBoundingClientRect();this.camera=new i.PerspectiveCamera(50,t/s,3,10),this.camera.position.z=5.3,this.scene=new i.Scene,this.canvas=e,this.canvasX=a+t/2,this.canvasY=n+s/2,this.mouse=new i.Vector2(0,0),this.faceTarget=new i.Vector3(0,0,15),this.eyesTarget=new i.Vector3(0,0,15),this.renderer=new i.WebGLRenderer({antialias:!0,canvas:e,alpha:!0,preserveDrawingBuffer:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(t,s),this.renderer.toneMapping=i.ACESFilmicToneMapping,this.renderer.toneMappingExposure=1,this.renderer.outputEncoding=i.sRGBEncoding,this.isSpinning=!0,this.isLoaded=!1,this.addLights(),this.addAmbienOclusion(),this.addEvents()}addEvents(){window.addEventListener("resize",(()=>{const{width:e,height:t,left:s,top:i}=this.canvas.getBoundingClientRect();this.canvas.setAttribute("width",e+""),this.canvas.setAttribute("height",t+""),this.canvasX=s+e/2,this.canvasY=i+t/2,this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t),this.composer.setSize(e,t)})),window.addEventListener("mousemove",(e=>{this.isSpinning=!1,this.mouse.x=(e.clientX-this.canvasX)/50,this.mouse.y=-(e.clientY-this.canvasY)/50}))}render(){this.composer.render()}animate(){this.isLoaded&&(requestAnimationFrame(this.animate.bind(this)),this.isSpinning?this.avatar.rotateY(-.02):(this.faceTarget.x+=.05*(this.mouse.x-this.faceTarget.x),this.faceTarget.y+=.05*(this.mouse.y-this.faceTarget.y),this.eyesTarget.x+=.065*(this.mouse.x-this.eyesTarget.x),this.eyesTarget.y+=.065*(this.mouse.y-this.eyesTarget.y),this.avatar.lookAt(this.faceTarget),this.eyes.lookAt(this.eyesTarget)),this.render())}addAmbienOclusion(){const e=new o.RenderPass(this.scene,this.camera),t=new h.SAOPass(this.scene,this.camera,!1,!0);this.composer=new r.EffectComposer(this.renderer),t.params.output=1,this.composer.addPass(e),this.composer.addPass(t)}addLights(){const e=new i.PointLight(16383903,.5);e.position.z=70,e.position.y=-70,e.position.x=-70,this.scene.add(e);const t=new i.PointLight(16768477,.5);t.position.z=70,t.position.x=-70,t.position.y=70,this.scene.add(t);const s=new i.PointLight(16775113,.5);s.position.z=70,s.position.x=70,s.position.y=-70,this.scene.add(s);const a=new i.AmbientLight(16777215,.05);this.scene.add(a)}loadGltf(){const e=new n.DRACOLoader;return e.setResourcePath,e.setDecoderPath("js/gltf/"),e.setDecoderConfig({type:"js"}),new Promise(((t,s)=>{(new a.GLTFLoader).setPath("models/").setDRACOLoader(e).load("avatar.gltf",(e=>{this.avatar=new i.Group,this.avatar.position.x=.2,this.avatar.add(...e.scene.children.filter((e=>"Mesh"===e.type))),this.scene.add(this.avatar),this.eyes=new i.Group,this.avatar.add(this.eyes),this.eyes.add(this.avatar.getObjectByName("Eyes")),this.isLoaded=!0,t()}),(()=>{}),s)}))}}!function(){const e=document.querySelector(".avatar"),t=new d(e);t.loadGltf().then((()=>{t.animate(),e.style.backgroundImage=""}))}()}},e=>{e.O(0,[216],(()=>(863,e(e.s=863)))),e.O()}]);